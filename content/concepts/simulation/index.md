---
title: Simulation
seotitle: Gatling Simulation scripting reference
description: Learn about the structure of the Gatling simulation, including required imports, protocol configuration and setUp.
lead: "Learn about the main parts of a Gatling simulation: DSL imports, scenario definitions, simulation definitions, and hooks."
aliases:
  - /reference/script/core/simulation/
---

`Simulation` is the parent class (function in JavaScript|TypeScript) your tests must extend so Gatling can launch them.

{{< alert warning >}}
We recommend that your Simulation's name does not start with `Test`.
Some tools such as Maven Surefire aggressively consider that all classes with such naming patterns are for them to handle, and they will try to launch them.
{{< /alert >}}

## DSL imports

The Gatling DSL requires some imports:

{{< include-code "imports" >}}

{{< alert warning >}}
Do not try to "optimize imports" with your IDE, you'd break everything.
Just copy-paste those imports wherever you want to use Gatling DSL.
{{< /alert >}}

{{< alert warning >}}
Beware that any class that doesn't belong to those packages is considered private, not an API, and hence subject to change at any time without notice.
{{< /alert >}}

## setUp

Most pieces of your tests can possibly be extracted into other helper classes (helper functions in JavaScript|TypeScript) so you can bring your own test libraries: scenarios, protocols, headers, injection profiles, etc.

The only mandatory piece in your Simulations is that they must call the `setUp` method exactly once in their constructor to register the test components.

{{< include-code "setUp" >}}

which correspond to injecting one single user into the `scn` scenario.

It's possible to have multiple populations, ie scenarios with an associated injection profile, in the same simulation:

{{< include-code "setUp-multiple" >}}

For more information regarding scenarios, see the dedicated section [here]({{< ref "scenario" >}}).

For more information regarding injection profiles, see the dedicated section [here]({{< ref "injection" >}}).

## Protocols configuration

Protocols configurations can be attached
* either on the setUp, in which case they are applied on all the populations
* or on each population, so they can have different configurations

{{< include-code "protocols" >}}

For more information regarding protocols configurations, see the HttpProtocol section [here]({{< ref "/reference/script/http/protocol" >}}).

## Acceptance criteria

Assertions are configured on the setUp.

{{< include-code "assertions" >}}

For more information regarding assertions, see the dedicated section [here]({{< ref "assertions" >}}).

## Global pause configuration

The pauses can be configured on `Simulation` with a bunch of methods:

{{< include-code "pauses" >}}

## Shaping throughput

Some users might want to reason in terms of throughput/requests per second instead of virtual users.

If your virtual users perform only one request each, you should use an [open workload model]({{< ref "injection/#open-model" >}}) for this, such as `constantUsersPerSec`.

Otherwise, in our opinion, you're going to run into trouble because you won't have any means of controlling which request gets executed.

Still, you can try and use the `throttle` method, that can be defined either globally or per scenario.

What `throttle` do is that it:
* **disables all the pauses**
* **caps** your throughput. It can't generate a throughput that's higher than the one normally generated by your simulation once pauses are disabled.

Throttling is currently only supported for HTTP requests and JMS.

{{< alert warning >}}
* Throttling should only be used with single request scenarios. Otherwise, distribution between multiple requests is likely to be unbalanced.
* Beware that all excess traffic gets pushed into an unbounded queue, possibly resulting in an OutOfMemoryError if your normal throughput is way higher than the normal one.
* Gatling will automatically interrupt your test at the end of the throttle, just like it does with [`maxDuration`]({{< ref "#maximum-duration" >}}).
{{< /alert >}}

{{< include-code "throttling" >}}

This simulation will reach 100 req/s with a ramp of 10 seconds, then hold this throughput for 1 minute, jump to 50 req/s and finally hold this throughput for 2 hours.

The building blocks for throttling are:

* `reachRps(target).in(duration)`: target a throughput with a ramp over a given duration.
* `jumpToRps(target)`: jump immediately to a given targeted throughput.
* `holdFor(duration)`: hold the current throughput for a given duration.

{{< alert tip >}}
`in` is a reserved keyword in Kotlin.
You can either protect it with backticks `` `in` `` or use the `during` alias instead.
{{< /alert >}}

## Maximum duration

Finally, with `maxDuration` you can force your run to terminate based on a duration limit, even if some virtual users are still running.

It is useful if you need to bound the duration of your simulation when you can't predict it.

{{< include-code "max-duration" >}}

## Hooks

Gatling provides two hooks:

* `before` for executing some arbitrary code before the simulation actually runs
* `after` for executing some arbitrary code after the simulation actually runs

The lifecycle is as follows:

1. Gatling starts
2. Simulation constructor is called, and all the code in the class body that is not delayed in the `before` and `after` hooks is executed.
3. `before` hook is executed
4. Simulation runs
5. Simulation terminates
6. `after` hook is executed
7. HTML reports are generated if enabled
8. Gatling shuts down

{{< include-code "hooks" >}}

{{< alert tip >}}
You won't be able to use Gatling DSL in there, as it's only intended for load test. You can only use your own code.
If you're looking for executing Gatling DSL, you might consider using [sequential scenarios]({{< ref "injection#sequential-scenarios" >}}).
{{< /alert >}}

## Deployment information (Gatling Enterprise only) {#deployment-info}

When running tests on Gatling Enterprise, you might be interested in some information about the Load Generator running the test.

{{< alert warning >}}
`deploymentInfo` is only effective when running with Gatling Enterprise, otherwise it's just a noop.
{{< /alert >}}

{{< include-code "deployment-info" >}}
